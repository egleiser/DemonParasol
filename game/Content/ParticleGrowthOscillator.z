/********************************/
/*  Particle Growth Oscillator  */
/*                              */
/*  Written by: Jason Clark     */
/*              & Eric Gleiser  */
/*                              */
/*  Last Updated: 01/24/2015    */
/********************************/

enum CurveTypes {SinCurve, CosCurve, CustomCurve}

class ParticleGrowthOscillator : ZilchComponent
{
    [Dependency]
    var LinearParticleAnimator:LinearParticleAnimator = null;
    
    [Property]
    var CurveType:CurveTypes = CurveTypes.SinCurve;
    [Property]
    var CustomCurve:SampleCurve = null;
    
    [Property]
    var Oscillation:Real = 0.0;
    [Property]
    var Amplitude:Real = 0.0;
    [Property]
    var VerticalShift:Real = 0.0;
    [Property]
    var HorizontalShift:Real = 0.0;
    
    var Age:Real = 0.0;
    
    var Growth:Real = 0.0;
    
    //var CurveChosen : ??? = ???
    
    function Initialize(init : CogInitializer)
    {
        //if(this.CurveType == CurveTypes.SinCurve)
        //{
        //    this.CurveChosen = Math.Sin;
        //}
        //if(this.CurveType == CurveTypes.CosCurve)
        //{
        //    this.CurveChosen = Math.Cos;
        //}
        //if(this.CurveType == CurveTypes.CustomCurve)
        //{
        //    this.CurveChosen = this.SampleCurve;
        //}
        //this.Growth = this.Owner.LinearParticleAnimator.Growth;
        Zero.Connect(this.Space, Events.LogicUpdate, this.OnLogicUpdate);
    }

    function OnLogicUpdate(event : UpdateEvent)
    {
        
        if(this.CurveType == CurveTypes.SinCurve)
        {
            this.Owner.LinearParticleAnimator.Growth = (Math.Sin((event.TimePassed - this.HorizontalShift) * this.Oscillation) * this.Amplitude) + this.VerticalShift;
        }
        if(this.CurveType == CurveTypes.CosCurve)
        {
            this.Owner.LinearParticleAnimator.Growth = (Math.Cos((event.TimePassed - this.HorizontalShift) * this.Oscillation) * this.Amplitude) + this.VerticalShift;
        }
        if(this.CurveType == CurveTypes.CustomCurve)
        {
            if(this.CustomCurve != null)
            {
                this.Owner.LinearParticleAnimator.Growth = this.CustomCurve.Sample(event.TimePassed);
            }
            else
            {
                Console.WriteLine("You forgot to choose your Custom Curve!");
            }
        }
    }
}
